# Archivo generado por Ansible para dnsmasq (DHCP + DNS)
# Interfaz interna del laboratorio
interface={{ router_internal_interface }}
bind-interfaces
listen-address={{ router_gateway_ip }}

# Dominio local
domain={{ dnsmasq_domain | default(router_dns_domain | default('lab.local')) }}
expand-hosts

# Servidores DNS upstream
{% for dns in (upstream_dns | default(router_dns_upstreams | default([]))) %}
server={{ dns }}
{% endfor %}

# Rango DHCP (usar netmask correcta de la LAN)
dhcp-range={{ dnsmasq_dhcp_range_start | default(router_dhcp_range_start) }},{{ dnsmasq_dhcp_range_end | default(router_dhcp_range_end) }},{{ (router_internal_address ~ '/' ~ router_internal_prefix) | ipaddr('netmask') }},{{ router_dhcp_lease | default('12h') }}

# Gateway y DNS ofrecidos por DHCP
dhcp-option=option:router,{{ router_gateway_ip }}
dhcp-option=option:dns-server,{{ router_gateway_ip }}

## Nota: En Debian, /etc/dnsmasq.conf ya incluye conf-dir=/etc/dnsmasq.d por defecto.
